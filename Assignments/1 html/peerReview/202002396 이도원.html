<html>
  <head>
    <meta charset="utf-8">
    <title>My First Assignment Page</title>
  </head>
  <body>
    <fieldset>
      <legend><h1>SCORE CALCULATOR</h1></legend>
    
    <div>
      <div float="left"><p><a href="https://wis.hufs.ac.kr/src08/jsp/index.jsp" target="_blank"><img src="https://wis.hufs.ac.kr/src08/images/main/index_top_logo.png" alt="PHP Logo" /></a></p></div>
      <div float="left">(Go to Hufs Portal for checking your grade)</div>
    </div>
    <br>
    <div id="res" style="border: 1px solid black;">
      <p style="font-size: 20px;">If You enter your information, you can get Average grade, remaing credit</p>
      <p style="font-size: 20px; color: red;">It doesn't support convergence major.</p>
      <p style="font-size: 20px; color: red">If you are Natural Science Student, who are befor class of 2021, Choose Other rather than Natural Science.</p>
      <p style="font-size: 20px; color: red">You can choose more than one type, but only One which is the leftmost is applied.</p>
    </div>
    <br>
    <table>
      <tr>
        <td>Option</td>
        <td>
          <div style="border: 1px solid black; width: 730px;">
            <label><input type="radio" name="gr" value="1">Interpretation and Translation</label>
            <label><input type="radio" name="gr" value="2">Engineering, Madical Engineering</label>
            <label><input type="radio" name="gr" value="3">Natural Science</label>
            <label><input type="radio" name="gr" value="4">Other</label>
          </div>
        </td>
      </tr>
      <tr>
        <td></td>
        <td>
          <div style="border: 1px solid black; width: 330px;">
            <label><input type="radio" name="majr" value="1">Double Major</label>
            <label><input type="radio" name="majr" value="2">Double Minor</label>
            <label><input type="radio" name="majr" value="3">None</label>
          </div>
        </td>
      </tr>
    </table>

    <br>
    <br>
    <table border = "1" id = table>
      <th style="height: 50px; font-size: 25px; background-color: aqua;">Subject Name</th>
      <th style="height: 50px; font-size: 25px; background-color: aqua">Credit</th>
      <th style="height: 50px; font-size: 25px; background-color: aqua">Score</th>
      <th style="height: 50px; font-size: 25px; background-color: aqua">Type</th>
      <tr>
        <td><input type="text" style="width: 1200px; height: 60px; text-align: center; font-size: 25px;"></td>
        <td><input type="number" class="Credit" min="0" max="5" step="1" value="3.0" id="credit" style="width: 80px; height: 60px; text-align: center; font-size: 20px;"/></td>
        <td><input type="number" class="Score" min="0" max="4.5" step="0.5" value="3.0" id="score" style="width: 80px; height: 60px; text-align: center; font-size: 20px;"/></td>
        <td style="width:600px">
          <label>
            <input type="checkbox" name = "w" value="Major" class="ma"> Major
          </label>
          <label>
            <input type="checkbox" name="w" value="DoubleMajor" class="dm"> Double Minor / Major
          </label>
          <label>
            <input type="checkbox" name="w" value="Subject" class="sb"> Subject
          </label>
          
        </td>

      <tr>
        <td><input type="text" style="width: 1200px; height: 60px; text-align: center; font-size: 25px;"></td>
        <td><input type="number" class="Credit" min="0" max="5" step="1" value="3.0" id="credit" style="width: 80px; height: 60px; text-align: center; font-size: 20px;"/></td>
        <td><input type="number" class="Score" min="0" max="4.5" step="0.5" value="3.0" id="score" style="width: 80px; height: 60px; text-align: center; font-size: 20px;"/></td>
        <td>
          <label>
            <input type="checkbox" name="w" value="Major" class="ma"> Major
          </label>
          <label>
            <input type="checkbox" name="w" value="DoubleMajor" class="dm"> Double Minor / Major
          </label>
          <label>
            <input type="checkbox" name="w" value="Subject" class="sb"> Subject
          </label>
      
        </td>
    </table>
    <button id = "addrow" onclick = "add_row()" style="width: 100px; height: 40px;">Add Row</button>
    <button id="remrow" onclick="rem_row()" style="width: 100px; height: 40px;">Remove Row</button>
    <button id="calculate" onclick="cal()" style="width: 100px; height: 40px;"> Calculate</button>
    <br>
    <br>
    
    </fieldset>

  <script>
    function add_row(){
      var table = document.getElementById("table");
      var row = table.insertRow(table.rows.length);
      var cell0 = row.insertCell();
      var cell1 = row.insertCell();
      var cell2 = row.insertCell();
      var cell3 = row.insertCell();

      cell0.style.height = "20px";
      cell0.innerHTML = '<input type="text" style="width: 1200px; height: 60px; text-align: center; font-size: 25px;">'
      cell1.innerHTML = '<input type="number" class="Credit" min="0" max="5" step="1" value="3.0" id="credit" style="width: 80px; height: 60px; text-align: center; font-size: 20px;"/>';
      cell2.innerHTML = '<input type="number" class="Score" min="0" max="4.5" step="0.5" value="3.0" id="score" style="width: 80px; height: 60px; text-align: center; font-size: 20px;"/>';
      cell3.innerHTML = '<label><input type= "checkbox" name= "w" value= "Major" class="ma"> Major</label> <label><input type= "checkbox" name= "w" value= "DoubleMajor" class="dm"> Double Minor / Major</label> <label><input type= "checkbox" name= "w" value= "Subject" class="sb"> Subject</label>'
      console.log(table.rows.length)
    }
    function rem_row() {
      var table = document.getElementById("table");
      if (table.rows.length > 2){
        table.deleteRow(table.rows.length-1);
      }
    }
    function cal() {
        var table = document.getElementById("table");
        var score = document.getElementsByClassName("Score");
        var credit = document.getElementsByClassName("Credit");
        var ma = document.getElementsByClassName("ma");
        var dm = document.getElementsByClassName("dm");
        var sb = document.getElementsByClassName("sb");
        var re = document.getElementById("res");
        var gr = document.getElementsByName("gr");
        var majr = document.getElementsByName("majr");
        var tl_major_s = 0;
        var tl_doublem_s = 0;
        var tl_sub_s = 0;
        var tl_s = 0;
        var tl_major_c = 0;
        var tl_doublem_c = 0;
        var tl_sub_c = 0;
        var key_gr;
        var key_dm;

        console.log("22")

        for (var i = 0; i < gr.length; i++) {
          if (gr[i].checked == true) {
            key_gr = i;
            break;
          }
        }
        for (var i = 0; i < majr.length; i++) {
          if (majr[i].checked == true) {
            key_dm = i;
            break;
        }
      }
        

        for(var i = 0; i<score.length; i++) {
          if(ma[i].checked) {
            tl_major_s += parseFloat(score[i].value) * parseInt(credit[i].value);
            tl_major_c += parseInt(credit[i].value);
            continue;
          }
          else if(dm[i].checked) {
            tl_doublem_s += parseFloat(score[i].value) * parseInt(credit[i].value);
            tl_doublem_c += parseInt(credit[i].value);
            continue;
          }
          else if(sb[i].checked) {
            tl_sub_s += parseFloat(score[i].value) * parseInt(credit[i].value);
            tl_sub_c += parseInt(credit[i].value);
            continue;
          }
        }
        //Clear
        re.innerHTML = ""

        //Total Credit
        re.innerHTML += '<h2 style="margin-left:30px;">Result</h2>'+'<h3 style="margin-left:40px;">Credit</h3>'+ '<ul type="disc">';
        re.innerHTML += '<li style="margin-left:50px">Major: ' + tl_major_c + '</li>';
        if(key_dm != 2) {re.innerHTML += '<li style="margin-left:50px">Double Major/Minor: ' + tl_doublem_c + '</li>'}
        re.innerHTML += '<li style="margin-left:50px">Subject: ' + tl_sub_c + '</li><br><br>';

        //Average Grade
        re.innerHTML += '<h3 style="margin-left:40px;">Average Grade</h3>' + '<ul type="disc">';
        re.innerHTML += '<li style="margin-left:50px">Major: ' + (tl_major_s/tl_major_c) + '</li>';
        if (key_dm !=2 ) { re.innerHTML += '<li style="margin-left:50px">Double Major/Minor: ' + (tl_doublem_s/tl_doublem_c) + '</li>' }
        re.innerHTML += '<li style="margin-left:50px">Subject: ' + (tl_sub_s/tl_sub_c) + '</li><br><br>';

        //Remain Credit
        var grdic = [[[70,42,32,150],[57,42,32,134],[54,42,32,134], [54, 42, 32, 134]],[[70,21,32,150],[66,21,32,134],[60,21,32,134],[54,21,32,134]],[[78,32,150],[75,32,134],[70,32,134],[70,32,134]]]
        re.innerHTML += '<h3 style="margin-left:40px;">Remaining Credit</h3>' + '<ul type="disc">';
        re.innerHTML += '<li style="margin-left:50px">Major: ' + (grdic[key_dm][key_gr][0]- tl_major_c) + '</li>';
        if(flag = true) {
          re.innerHTML += '<li style="margin-left:50px">Subject: ' + (grdic[key_dm][key_gr][1] - tl_sub_c) + '</li>';
          re.innerHTML += '<li style="margin-left:50px">Total: ' + (grdic[key_dm][key_gr][2] - (tl_major_c+tl_sub_c)) + '</li><br><br>';
        }
        else {
          re.innerHTML += '<li style="margin-left:50px">Double Major/Minor: ' + (gradic[key_dm][key_gr][1] - tl_doublem_c) + '</li>';
          re.innerHTML += '<li style="margin-left:50px">Subject: ' + (grdic[key_dm][key_gr][2] - tl_sub_c) + '</li><br><br>';
          re.innerHTML += '<li style="margin-left:50px">Total: ' + (grdic[key_dm][key_gr][3] - (tl_major_c + tl_doublem_c + tl_sub_c)) + '</li><br><br>';
        }
      }
  </script>
  </body>
</html>